---
title: 这里写你的文章标题
published: 2026-01-30
description: 这里写一两句简单的文章介绍
image: ""
category: 随意
tags:
  - 随笔
draft: true
---
# 1. 核心控制方程组 (Governing Equations)

本系统的核心由四个相互耦合的微分方程组成，描述了电量、端电压、温度与寿命的演化过程 。

## 1.1 电量演化 (SOC Dynamics)

基于库仑计法的稳健形式：

$$\frac{d(SOC)}{dt} = -\frac{I(t)}{3600 \cdot Q_{nom} \cdot SOH(t)}$$

- **物理意义**：描述荷电状态的瞬时变化率 。
    
    
- **3600 的作用**：将电池额定容量 $Q_{nom}$ 从安时 (Ah) 转换为库仑 (As)，以匹配以秒为单位的时间导数 $dt$ 。
    

- **SOH 耦合**：分母包含健康状态 $SOH(t)$，体现了随着电池老化，同样的电流会导致 SOC 下降得更快 。
    


## 1.2 核心：电流 - 功率非线性耦合 (Current-Power Coupling)

引入内阻分压效应，解一元二次方程 $P_{total} = (V_{oc} - I \cdot R_{total}) \cdot I$ 得 ：


$$I(t) = \frac{V_{oc}(SOC) - \sqrt{V_{oc}(SOC)^2 - 4 \cdot R_{total}(T, SOC) \cdot P_{total}(t)}}{2 \cdot R_{total}(T, SOC)}$$

- **物理意义**：当根号内的项趋向于 $0$（即 $V_{oc}^2 \approx 4RP$）时，电流 $I(t)$ 发生非线性暴增，这解释了低电量或极冷环境下手机突然关机的**电压崩塌 (Voltage Collapse)** 现象 。
    

## 1.3 热力学方程 (Thermal Dynamics)

$$m c_p \frac{dT}{dt} = \underbrace{I(t)^2 \cdot R_{total}(T, SOC)}_{Joule\ Heat} - \underbrace{hA(T - T_{env})}_{Cooling}$$

- **物理意义**：描述电池产热与散热的博弈 。重度负载产生的焦耳热是导致过热的主要驱动力 。
    

## 1.4 连续化老化方程 (Aging Dynamics)

$$\frac{dSOH}{dt} = -K_{aging}(T) \cdot |I(t)|$$

$$K_{aging}(T) = k_{ref} \cdot \exp\left( \frac{E_{aging}}{R_g} \left| \frac{1}{T} - \frac{1}{T_{opt}} \right| \right)$$

- **物理意义**：老化速率受温度 V 型曲线调制 。高温下的 SEI 膜生长与低温下的锂析出共同导致了健康状态的连续衰减 。

---

# 2. 白盒功耗子模型 (White-box Load Model)

将复杂的硬件行为转化为系统总功率 $P_{total}(t)$ ：


$$P_{total}(t) = P_{base} + P_{screen} + P_{cpu} + P_{net} + P_{gps} + P_{bg}$$

1. **屏幕功耗 ($P_{screen}$)**：引入开关状态 $\delta_{on}$ 与非线性伽马修正 ：
$$P_{screen}(t) = \delta_{on}(t) \cdot (P_{panel\_base} + k_{scr} \cdot L(t)^\beta)$$
    
    - $\beta \approx 1.6 \sim 2.2$ 体现了 OLED/LCD 功耗随亮度非线性增长的特性 。

        
2. **处理器功耗 ($P_{cpu}$)**：包含基于 Sigmoid 函数的热节流反馈 ：

    $$P_{cpu}(t) = P_{leak} + k_{cpu} \cdot [\alpha_{req}(t) \cdot \eta_{throttle}(T)]^3$$
    
    $$\eta_{throttle}(T) = \frac{1}{1 + \exp(k_{th} \cdot (T - T_{crit}))}$$
    
    - 遵循 CMOS 电路立方律，且在 $T > T_{crit}$ 时平滑限制 CPU 负载以防止过热失控 。

        
3. **网络功耗 ($P_{net}$)**：考虑制式乘数与信号波动的随机性 ：
$$P_{net}(t) = M_{tech} \cdot (P_{net\_idle} + knet \cdot e^{-\lambda \cdot \gamma(t)})$$
    
    - 信号强度 $\gamma(t)$ 由 OU 随机过程生成，模拟信号转差时发射功率的指数级上升 。

        
4. **离散任务 ($P_{gps}, P_{bg}$)**：
    
    - **GPS**: $P_{gps}(t) = \delta_{gps}(t) \cdot P_{mod\_gps}$ 。

    - **后台**: $P_{bg}(t) = \sum P_{wake} \cdot \mathbb{I}_{sync, k}(t)$，以周期性脉冲模拟闲置时的能耗爆发 。

---

# 3. 电池参数子模型 (Parameter Sub-models)

## 3.1 复合内阻模型 (Internal Resistance)

$$R_{total} = R_{ref} \cdot \exp\left( \frac{E_a}{R_g} \left( \frac{1}{T} - \frac{1}{T_{ref}} \right) \right) + \frac{\beta_{pol}}{SOC^k + \epsilon}$$

- **物理意义**：Arrhenius 项解释了“环境寒冷导致内阻暴增”，极化项则解释了“电量末端掉电快” 。

## 3.2 开路电压曲线 (OCV)

$$V_{oc}(SOC) = c_0 + c_1 \cdot SOC + c_2 \cdot SOC^2 + c_3 \cdot SOC^3$$

- **物理意义**：采用 3 阶多项式拟合开源数据集，确保在边界处（0% 与 100%）的数值解稳定性，避免龙格现象 。
    

---

# 4. 优化总结：科学性与应用价值

1. **解释力增强**：通过电流 - 功率耦合公式，模型能够定量解释为什么 5G 网络或高亮游戏在寒冷户外会导致手机“跳电”或意外关机 。

2. **动态闭环**：热节流函数的引入模拟了真实操作系统的节能策略，为后续针对厂商的建议提供了理论支撑 。

3. **数值稳健性**：将温度修正集中在内阻而非直接修改分母容量，显著提升了模型在极端工况下的仿真成功率






本框架分为**系统变量定义**、**核心动力学引擎**、**功耗驱动模块**和**物理特性模块**四个核心部分。

---

### 1. 系统变量与常数定义 (Variables & Units)

在建模与代码实现前，必须统一 SI 单位制以确保物理逻辑的一致性：

- **状态变量 (State Vector $y$)**:
    
    - $SOC(t)$: 荷电状态 ($0.0$ 至 $1.0$)，代表剩余能量百分比。
        
    - $T(t)$: 电池瞬时温度 (单位: $K$)，直接影响内阻与容量。
        
    - $SOH(t)$: 健康状态 ($1.0$ 为全新)，随累积电荷通量衰减。
        
- **关键物理常数**:
    
    - $Q_{nom}$: 额定容量 (单位: $Ah$)。在公式中需使用 $Q_{SI} = Q_{nom} \times 3600$ (单位: $As$)。
        
    - $R_g$: 理想气体常数 ($8.314\ J/mol\cdot K$)。
        
    - $m, c_p$: 电池质量 ($kg$) 与比热容 ($J/kg\cdot K$)。
        

---

### 2. 核心动力学引擎 (The ODE Solver Logic)

这是 ODE 求解器的核心，描述了三个状态变量随时间 $t$ 的连续演化:

#### 2.1 电量与寿命演化

$$\frac{d(SOC)}{dt} = -\frac{I(t)}{3600 \cdot Q_{nom} \cdot SOH(t)}$$

$$\frac{dSOH}{dt} = -K_{aging}(T) \cdot |I(t)|$$

- **老化速率因子 $K_{aging}(T)$**: 采用 V 型温度特性描述：
    
    $$K_{aging}(T) = k_{ref} \cdot \exp\left( \frac{E_{aging}}{R_g} \left| \frac{1}{T} - \frac{1}{T_{opt}} \right| \right)$$

#### 2.2 热力学平衡

描述产热与散热的动态博弈:

$$\frac{dT}{dt} = \frac{I(t)^2 \cdot R_{total}(T, SOC) - hA(T - T_{env})}{m \cdot c_p}$$

- 其中 $hA$ 为综合散热系数，$T_{env}$ 为环境温度。
    

---

### 3. 功耗驱动模块 (Load & Power Decomposition)

在计算微分项前，需根据当前状态求解瞬时电流 $I(t)$。

#### 3.1 瞬时电流非线性求解 (The Quadratic Solver)

基于功率平衡方程 $P_{total} = (V_{oc} - I \cdot R_{total}) \cdot I$ 解得：

$$I(t) = \frac{V_{oc}(SOC) - \sqrt{V_{oc}(SOC)^2 - 4 \cdot R_{total}(T, SOC) \cdot P_{total}(t)}}{2 \cdot R_{total}(T, SOC)}$$

- **物理崩溃边界**: 若 $V_{oc}^2 - 4RP < 0$，系统判定为“电压崩塌”，手机强制关机。
    

3.2 精细化总功耗分解 ($P_{total}$)

$$P_{total}(t) = P_{screen} + P_{cpu} + P_{net} + P_{gps} + P_{bg} + P_{base}$$

1. **屏幕功耗子模块 (非线性发光)**:
    
    $$P_{screen}(t) = \delta_{on}(t) \cdot \left[ P_{panel\_base} + k_{scr} \cdot \left( \frac{L(t)}{L_{max}} \right)^\beta \right]$$
    
    - $\beta \approx 1.6 \sim 2.2$ 为伽马因子，描述亮度增加时的能耗非线性增长。
        
2. **处理器热耦合子模块 (静态漏电 + 动态热节流)**:
    
    $$P_{cpu}(t, T) = \underbrace{P_{leak\_ref} \cdot (1 + \lambda_{leak}(T - T_{ref}))}_{\text{静态漏电(随温升)}} + \underbrace{k_{cpu} \cdot [\alpha_{req}(t) \cdot \eta_{throttle}(T)]^3}_{\text{动态负载(热节流)}}$$
    
    - **热节流函数**: $\eta_{throttle}(T) = \frac{1}{1 + \exp(k_{th} \cdot (T - T_{crit}))}$。
        
3. **随机网络通信子模块 (OU过程信号波动)**:
    
    $$P_{net}(t, \gamma) = M_{tech} \cdot \left[ P_{net\_idle} + k_{net} \cdot \exp(-\lambda_{snr} \cdot \gamma(t)) \right]$$
    
    - **随机过程**: $d\gamma(t) = \theta (\mu_{\gamma} - \gamma(t)) dt + \sigma_{\gamma} dW(t)$，模拟信号强度的均值回归。
        
4. **离散脉冲任务子模块 (GPS & 后台同步)**:
    
    $$P_{bg}(t) = N_{app} \cdot P_{wake} \cdot \mathbb{I}_{pulse}(t)$$
    
    - **脉冲函数**: 当 $\mod(t, T_{cycle}) < T_{duration}$ 时 $\mathbb{I}_{pulse}=1$，否则为 $0$。
        

---

### 4. 电池物理特性子模块 (Battery Physics)

4.1 复合内阻模型 $R_{total}$

$$R_{total}(T, SOC) = R_{ref} \cdot \exp\left( \frac{E_a}{R_g} \left( \frac{1}{T} - \frac{1}{T_{ref}} \right) \right) + \frac{\beta_{pol}}{SOC^k + \epsilon}$$

- 捕捉了**低温内阻激增**（Arrhenius 项）和**低电量极化阻力**（Polarization 项）。
    

#### 4.2 开路电压曲线 $V_{oc}$

$$V_{oc}(SOC) = c_0 + c_1 \cdot SOC + c_2 \cdot SOC^2 + c_3 \cdot SOC^3$$

- 基于实测数据的多项式拟合，确保计算平滑 。
    

---

### 5. 代码转化逻辑提示 (Implementation Notes)

- **随机过程预处理**: 由于随机微分方程在 ODE 求解器中可能导致不收敛，应在求解前预先生成信号强度数组并进行线性插值（如使用 `scipy.interpolate.interp1d`）。
    
- **终止条件 (Event Trigger)**: 设置 `event` 函数监控 $SOC$ 和电流方程根号项。一旦 $SOC \le 0.01$ 或出现电压崩塌，立即停止积分。
    
- **步长控制**: 推荐使用 `RK45` 方法。针对后台同步的秒级脉冲，需确保求解器的最大步长 `max_step` 小于脉冲持续时间 $T_{duration}$，以免遗漏瞬时功耗高峰。