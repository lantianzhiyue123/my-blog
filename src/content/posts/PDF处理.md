---
title: pdfæ‹†åˆ†_pythonè„šæœ¬
published: 2026-01-28
description: è¿™é‡Œå†™ä¸€ä¸¤å¥ç®€å•çš„æ–‡ç« ä»‹ç»
image: ""
category: python
tags:
  - python
draft: false
---
åŠŸèƒ½ï¼š

Â   - è‡ªåŠ¨è¯»å– PDF æ–‡ä»¶ä¸­çš„ç« èŠ‚ä¹¦ç­¾

Â  Â - æ ¹æ®ä¹¦ç­¾ç›®å½•ï¼Œå°† PDF æŒ‰ç« èŠ‚æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„ PDF æ–‡ä»¶

Â  Â - ä½¿ç”¨ç« èŠ‚æ ‡é¢˜ä½œä¸ºè¾“å‡ºæ–‡ä»¶å

Â  Â - æ”¯æŒé”™è¯¯å¤„ç†å’Œæ—¥å¿—è¾“å‡º
```
import fitz Â # PyMuPDF - ç”¨äºå¤„ç† PDF æ–‡ä»¶

import os Â # æ“ä½œç³»ç»Ÿæ¥å£ - ç”¨äºæ–‡ä»¶å’Œç›®å½•æ“ä½œ

  

def process_and_split_pdf(pdf_path):

Â  Â  # --- æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ ---

Â  Â  if not os.path.exists(pdf_path):

Â  Â  Â  Â  print(f"é”™è¯¯ï¼šæ–‡ä»¶ä¸å­˜åœ¨ - {pdf_path}")

Â  Â  Â  Â  return

Â  Â  # --- 1. åˆå§‹åŒ–è·¯å¾„ ---

Â  Â  base_dir = os.path.dirname(pdf_path)

Â  Â  file_name = os.path.basename(pdf_path).replace(".pdf", "")

Â  Â  output_folder = os.path.join(base_dir, f"{file_name}_æ‹†åˆ†ç‰ˆ")

Â  Â  if not os.path.exists(output_folder):

Â  Â  Â  Â  os.makedirs(output_folder)

  

Â  Â  # --- 2. æ‰“å¼€æ–‡æ¡£å¹¶è·å–ç›®å½• ---

Â  Â  try:

Â  Â  Â  Â  doc = fitz.open(pdf_path)

Â  Â  except Exception as e:

Â  Â  Â  Â  print(f"é”™è¯¯ï¼šæ— æ³•æ‰“å¼€PDFæ–‡ä»¶ - {e}")

Â  Â  Â  Â  return

Â  Â  toc = doc.get_toc()

Â  Â  chapters = [entry for entry in toc if entry[0] == 1]

Â  Â  if not chapters:

Â  Â  Â  Â  print("æœªæ£€æµ‹åˆ°æœ‰æ•ˆç« èŠ‚ä¹¦ç­¾ï¼Œè¯·æ£€æŸ¥PDFç›®å½•ç»“æ„ã€‚")

Â  Â  Â  Â  doc.close()

Â  Â  Â  Â  return

  

Â  Â  print(f"æ£€æµ‹åˆ° {len(chapters)} ä¸ªç« èŠ‚ï¼Œå‡†å¤‡å¼€å§‹å¤„ç†...")

  

Â  Â  # --- 3. å¾ªç¯å¤„ç†æ¯ä¸ªç« èŠ‚ ---

Â  Â  for i in range(len(chapters)):

Â  Â  Â  Â  level, title, start_page = chapters[i]

Â  Â  Â  Â  start_idx = start_page - 1

Â  Â  Â  Â  if i == 0:

Â  Â  Â  Â  Â  Â  start_idx = 0

Â  Â  Â  Â  if i < len(chapters) - 1:

Â  Â  Â  Â  Â  Â  end_idx = chapters[i+1][2] - 2 Â # ä¿®å¤ï¼šåˆ°ä¸‹ä¸€ç« å‰ä¸€é¡µ

Â  Â  Â  Â  else:

Â  Â  Â  Â  Â  Â  end_idx = len(doc) - 1

Â  Â  Â  Â  clean_title = "".join([c for c in title if c.isalnum() or c in (' ', '-', '_')]).strip()

Â  Â  Â  Â  if not clean_title:

Â  Â  Â  Â  Â  Â  clean_title = f"Chapter_{i+1}"

Â  Â  Â  Â  output_file = os.path.join(output_folder, f"{clean_title}.pdf")

  

Â  Â  Â  Â  new_doc = fitz.open()

Â  Â  Â  Â  # --- 4. ç›´æ¥å¤åˆ¶é¡µé¢ï¼ˆä¸åšå¢å¼ºå¤„ç†ï¼‰ ---

Â  Â  Â  Â  for page_num in range(start_idx, end_idx + 1):

Â  Â  Â  Â  Â  Â  try:

Â  Â  Â  Â  Â  Â  Â  Â  # ç›´æ¥ä»åŸæ–‡æ¡£å¤åˆ¶é¡µé¢

Â  Â  Â  Â  Â  Â  Â  Â  new_doc.insert_pdf(doc, from_page=page_num, to_page=page_num)

Â  Â  Â  Â  Â  Â  except Exception as e:

Â  Â  Â  Â  Â  Â  Â  Â  print(f"å¤„ç†ç¬¬{page_num+1}é¡µæ—¶å‡ºé”™: {e}")

Â  Â  Â  Â  Â  Â  Â  Â  continue

  

Â  Â  Â  Â  new_doc.save(output_file)

Â  Â  Â  Â  new_doc.close()

Â  Â  Â  Â  print(f"å·²å®Œæˆ: {clean_title} (ç¬¬{start_idx+1}è‡³{end_idx+1}é¡µ)")

  

Â  Â  doc.close()

Â  Â  print(f"\nå…¨éƒ¨å¤„ç†å®Œæˆï¼æ–‡ä»¶å¤¹ä½ç½®: {output_folder}")

  

# --- æ‰§è¡Œ ---

target_pdf = r"E:\BaiduNetdiskDownload\MATLABä¿¡å·å¤„ç† ç®—æ³•ã€ä»¿çœŸä¸å®ç° -.pdf"

process_and_split_pdf(target_pdf)
```
# ä¸€ã€ vscode ä»£ç é«˜äº®é¢œè‰²å’Œæ•°æ®ç±»å‹ï¼ˆé»˜è®¤ï¼‰
## 1. VS Code é¢œè‰²èº«ä»½å¯¹åº”è¡¨

| **é¢œè‰²**    | **ç¼–ç¨‹èº«ä»½**             | **ä»£ç ä¸­çš„ä¾‹å­**                                    | **ç®€å•ç†è§£**                      |
| --------- | -------------------- | --------------------------------------------- | ----------------------------- |
| **ç´«è‰²**    | **Keyword (å…³é”®å­—)**    | `def`, `if`, `not`, `return`, `try`, `except` | ç¼–ç¨‹è¯­è¨€è‡ªå¸¦çš„â€œè¯­æ³•éª¨æ¶â€ï¼Œä¸å¯æ›´æ”¹ã€‚           |
| **é»„è‰²**    | **Function (å‡½æ•°/æ–¹æ³•)** | `print`, `exists`, `join`, `open`, `replace`  | **â€œåŠ¨ä½œâ€**ã€‚è´Ÿè´£æ‰§è¡ŒæŸä¸ªå…·ä½“ä»»åŠ¡çš„æœºå™¨ã€‚       |
| **æµ…è“è‰²**   | **Variable (å˜é‡)**    | `pdf_path`, `base_dir`, `doc`, `e`            | **â€œå®¹å™¨â€**ã€‚ç”¨æ¥å­˜æ”¾æ•°æ®æˆ–åå­—çš„æ ‡ç­¾ã€‚        |
| **é’è‰²**    | **Module (æ¨¡å—)**      | `os`, `path`, `fitz`                          | **â€œå·¥å…·ç®±â€**ã€‚åœ¨ä½ çš„å›¾ä¸­ï¼Œæ¨¡å—åå’Œå˜é‡é¢œè‰²æ˜¯ä¸€è‡´çš„ã€‚ |
| **æ©™è‰²/æ£•è‰²** | **String (å­—ç¬¦ä¸²)**     | `"pdf_path"`, `".pdf"`, `f"é”™è¯¯..."`            | **â€œæ–‡æœ¬å†…å®¹â€**ã€‚å¼•å·é‡Œçš„çº¯æ–‡å­—ã€‚           |
| **ç»¿è‰²**    | **Comment (æ³¨é‡Š)**     | `# æ­¥éª¤ 1: ...`                                 | **â€œç¬”è®°â€**ã€‚ç»™äººç±»çœ‹çš„è§£é‡Šï¼Œä»£ç è¿è¡Œæ—¶ä¼šè·³è¿‡ã€‚    |
| æµ…è“è‰²       | type/class(ç±»)        |                                               |                               |
| æµ…è“è‰²       | parameter(å‚æ•°)        |                                               |                               |

---


# äºŒã€ try-except
**å°è¯•æ‰§è¡ŒæŸæ®µä»£ç ï¼Œå¦‚æœå‡ºé”™å°±æ•æ‰é”™è¯¯å¹¶å¤„ç†ï¼Œè€Œä¸æ˜¯è®©ç¨‹åºå´©æºƒ**ã€‚
```
Â # ============ æ­¥éª¤ 3: æ‰“å¼€ PDF å¹¶è¯»å–ä¹¦ç­¾ç›®å½• ============

Â  Â  try:

Â  Â  Â  Â  # ä½¿ç”¨ PyMuPDF æ‰“å¼€ PDF æ–‡ä»¶

Â  Â  Â  Â  doc = fitz.open(pdf_path)

Â  Â  except Exception as e:

Â  Â  Â  Â  print(f"é”™è¯¯ï¼šæ— æ³•æ‰“å¼€ PDF æ–‡ä»¶ - {e}")

Â  Â  Â  Â  return
```
ğŸš€ è¿›é˜¶ï¼šæ•æ‰ç‰¹å®šé”™è¯¯
```
try:
    doc = fitz.open(pdf_path)
except FileNotFoundError:
    # æ–‡ä»¶ä¸å­˜åœ¨æ—¶
    print("æ–‡ä»¶ä¸å­˜åœ¨")
except PermissionError:
    # æƒé™ä¸è¶³æ—¶
    print("æ²¡æœ‰æƒé™æ‰“å¼€è¯¥æ–‡ä»¶")
except Exception as e:
    # å…¶ä»–æ‰€æœ‰é”™è¯¯
    print(f"å…¶ä»–é”™è¯¯ï¼š{e}")
```
ğŸ“Š ä¸åŒé”™è¯¯æƒ…å†µçš„è¾“å‡º
é”™è¯¯æƒ…å†µ	è¾“å‡ºå†…å®¹
æ–‡ä»¶ä¸å­˜åœ¨	[Errno 2] No such file or directory: '...'
æ–‡ä»¶è¢«å ç”¨	[Errno 13] Permission denied: '...'
æ–‡ä»¶æŸå	cannot open damaged file
å…¶ä»–é”™è¯¯	å…·ä½“çš„ PyMuPDF é”™è¯¯ä¿¡æ¯
# ğŸ¯ ä¸ºä»€ä¹ˆè¦æ‰“å° {e}ï¼Ÿ

- âœ“Â **å¸®åŠ©è°ƒè¯•**ï¼šçŸ¥é“å…·ä½“æ˜¯ä»€ä¹ˆé”™è¯¯
- âœ“Â **ç”¨æˆ·å‹å¥½**ï¼šç”¨æˆ·èƒ½ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆ
- âœ“Â **å¿«é€Ÿå®šä½**ï¼šå¿«é€Ÿæ‰¾åˆ°é—®é¢˜åŸå› å¹¶ä¿®å¤

# ä¸‰ã€ ç±»ä¸å¯¹è±¡
## Python å†…ç½®â€œåŸå‚æ¨¡å…·ï¼ˆclass/type)â€æ€»ç»“è¡¨

| **åˆ†ç±»** | **æ¨¡å…·åç§° (Type)** | **VS Code æ‚¬åœæ ‡è¯†** | **å®ç‰©ç¤ºä¾‹ (Object)**    | **ä½ çš„ä»£ç ä¸­å“ªé‡Œå‡ºç°äº†ï¼Ÿ**                   | **æ ¸å¿ƒç”¨é€”**         |
| ------ | --------------- | ---------------- | -------------------- | --------------------------------- | ---------------- |
| **æ–‡æœ¬** | **`str`**       | `(class) str`    | `"MATLAB"`, `".pdf"` | `pdf_path`, `clean_title`         | å­˜å‚¨æ–‡å­—ä¿¡æ¯ã€è·¯å¾„ã€æ ‡é¢˜ç­‰    |
| **æ•´æ•°** | **`int`**       | `(class) int`    | `1`, `50`, `0`       | `start_page`, `page_num`, `level` | è®¡æ•°ã€è®¡ç®—é¡µç ã€å¾ªç¯ç´¢å¼•     |
| **åˆ—è¡¨** | **`list`**      | `(class) list`   | `[1, 2, 3]`          | `toc`, `chapters`                 | ä¸€ä¸ªæœ‰åºçš„å¤§ä»“åº“ï¼Œå¯ä»¥éšæ—¶å¢åˆ æ”¹ |
| **é€»è¾‘** | **`bool`**      | `(class) bool`   | `True`, `False`      | `if not chapters:` (éšå¼é€»è¾‘åˆ¤æ–­)       | åˆ¤æ–­æ˜¯éï¼Œæ§åˆ¶ä»£ç èµ°å“ªæ¡è·¯    |
| **å…ƒç»„** | **`tuple`**     | `(class) tuple`  | `(1, "æ ‡é¢˜", 5)`       | `entry` (ä¹¦ç­¾é‡Œçš„å•æ¡è®°å½•)                | åƒåˆ—è¡¨ä½†â€œå‡ºå‚å³å°æ­»â€ï¼Œä¸èƒ½å†æ”¹ |
| **å°æ•°** | **`float`**     | `(class) float`  | `3.14`, `0.5`        | (é€šå¸¸ç”¨äºè®¡ç®—ç™¾åˆ†æ¯”æˆ–åæ ‡)                    | å­˜å‚¨å¸¦æœ‰å°æ•°ç‚¹çš„ç²¾ç¡®æ•°å€¼     |
| **å­—å…¸** | **`dict`**      | `(class) dict`   | `{"a": 1}`           | (å¸¸ç”¨äºå­˜å‚¨å¸¦æ ‡ç­¾çš„æ•°æ®)                     | åƒå­—å…¸ä¸€æ ·ï¼Œé€šè¿‡â€œé”®â€æ‰¾â€œå€¼â€  |
| **èŒƒå›´** | **`range`**     | `(class) range`  | `range(0, 10)`       | `range(start_idx, end_idx + 1)`   | ä¸“é—¨ç”Ÿäº§ä¸€ä¸²è¿ç»­æ•°å­—çš„æ¨¡å…·    |
| **ç©ºå€¼** | **`None`**      | `NoneType`       | `None`               | `return` (ä¸å¸¦è¿”å›å€¼æ—¶é»˜è®¤è¿”å› None)        | ä»£è¡¨â€œä»€ä¹ˆéƒ½æ²¡æœ‰â€æˆ–â€œç©ºâ€    |

---
## 2. åº“è‡ªå¸¦çš„â€œå®šåˆ¶â€ç±»å‹ï¼šå¤æ‚çš„ç²¾å¯†ä»ªå™¨

è¿™äº›æ˜¯ä½ é€šè¿‡ `import` å¼•å…¥çš„â€œé«˜çº§å›¾çº¸â€ã€‚

| **æ¨¡å…· (ç±»/Type)**     | **å®ç‰© (å¯¹è±¡/Object)** | **ä½ çš„ä»£ç ä¸­çš„å…·ä½“è¡¨ç°**                                                                 |
| ------------------- | ------------------ | ------------------------------------------------------------------------------ |
| **`fitz.Document`** | `doc`              | **å›¾çº¸**ï¼šå®šä¹‰äº† PDF è¯¥æ€ä¹ˆæ‰“å¼€ã€æ€ä¹ˆå­˜ã€‚<br><br>  <br><br>**å®ç‰©**ï¼šä½ é‚£æœ¬ã€ŠMATLAB ä¿¡å·å¤„ç†ã€‹çš„ PDF å®ä½“ã€‚     |
| **`fitz.Page`**     | `page` (åœ¨å¾ªç¯é‡Œ)      | **å›¾çº¸**ï¼šå®šä¹‰äº†ä¸€é¡µçº¸ä¸Šæœ‰å“ªäº›æ–‡å­—å’Œå›¾ç‰‡ã€‚<br><br>  <br><br>**å®ç‰©**ï¼šè¿™ä¸ª PDF çš„ç¬¬ 50 é¡µã€‚                |
| **`os.PathLike`**   | `pdf_path`         | **å›¾çº¸**ï¼šå®šä¹‰äº†ä¸€ä¸ªåˆæ³•çš„æ–‡ä»¶è·¯å¾„é•¿ä»€ä¹ˆæ ·ã€‚<br><br>  <br><br>**å®ç‰©**ï¼š`E:\BaiduNetdisk...\xxx.pdf`ã€‚ |
![[image.png|599x110]]
    **åœ¨ fitz åº“çš„å†…éƒ¨ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·å†™çš„ï¼š**
class Document:
    # è¿™é‡Œæ˜¯å¤æ‚çš„ PDF å¤„ç†é€»è¾‘
    ...
open = Document  # ç»™ Document ç±»èµ·äº†ä¸€ä¸ªå¤–å·å« open  
æ‰€ä»¥è¯´ open Document éƒ½æ˜¯ç±»ï¼Œè€Œ doc æ˜¯å®šä¹‰çš„å¯¹è±¡


doc (Document å¯¹è±¡)
â”‚
â”œâ”€â”€ å±æ€§ï¼ˆPropertiesï¼‰- ç”¨ @ ç¬¦å·æ ‡è®°
â”‚   â”œâ”€â”€ page_count: int      # æ€»é¡µæ•°
â”‚   â”œâ”€â”€ metadata: dict       # å…ƒæ•°æ®ï¼ˆä½œè€…ã€æ ‡é¢˜ç­‰ï¼‰
â”‚   â”œâ”€â”€ is_pdf: bool         # æ˜¯å¦æ˜¯ PDF
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ æ–¹æ³•ï¼ˆMethodsï¼‰- å¯ä»¥è°ƒç”¨çš„å‡½æ•°
â”‚   â”œâ”€â”€ get_toc()            # è·å–ç›®å½•
â”‚   â”œâ”€â”€ __getitem__(i)       # doc[i] è·å–ç¬¬ i é¡µ
â”‚   â”œâ”€â”€ save(filename)       # ä¿å­˜æ–‡ä»¶
â”‚   â”œâ”€â”€ close()              # å…³é—­æ–‡ä»¶
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ åŒ…å«çš„é¡µé¢å¯¹è±¡
    â”œâ”€â”€ doc[0]: Page å¯¹è±¡    # ç¬¬ä¸€é¡µ
    â”œâ”€â”€ doc[1]: Page å¯¹è±¡    # ç¬¬äºŒé¡µ
    â””â”€â”€ doc[n]: Page å¯¹è±¡    # ç¬¬ n é¡µ
## å››ã€åˆ›å»ºåˆ—è¡¨ List
```
# âŒ æ™®é€šå†™æ³•ï¼ˆå†—é•¿ï¼‰
chapters = []
for entry in toc:
    if entry[0] == 1:
        chapters.append(entry)

# âœ“ åˆ—è¡¨æ¨å¯¼å¼ï¼ˆç®€æ´ï¼‰
chapters = [entry for entry in toc if entry[0] == 1]


chapters = [entry for entry in toc if entry[0] == 1]
#          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
#            ç»“æœ      éå†çš„å¯¹è±¡    å¾ªç¯å˜é‡    è¿‡æ»¤æ¡ä»¶
```
<mark style="background: #FFF3A3A6;">æ›´å¤šä¾‹å­</mark>
```
# ä¾‹å­ 1ï¼šæå–æ‰€æœ‰å¶æ•°
numbers = [1, 2, 3, 4, 5, 6]
evens = [n for n in numbers if n % 2 == 0]
# ç»“æœï¼š[2, 4, 6]

# ä¾‹å­ 2ï¼šæå–æ‰€æœ‰å§“å
people = [["å¼ ä¸‰", 20], ["æå››", 25], ["ç‹äº”", 30]]
names = [person[0] for person in people]
# ç»“æœï¼š["å¼ ä¸‰", "æå››", "ç‹äº”"]

# ä¾‹å­ 3ï¼šæå–åˆ†æ•°å¤§äº 60 çš„å­¦ç”Ÿ
scores = [("å°æ˜", 80), ("å°çº¢", 50), ("å°åˆš", 90)]
passed = [name for name, score in scores if score > 60]
# ç»“æœï¼š["å°æ˜", "å°åˆš"]
```
## äº”ã€ if __name__ == "__main__":

è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯ï¼š**åˆ¤æ–­å½“å‰ Python æ–‡ä»¶æ˜¯è¢«ç›´æ¥è¿è¡Œï¼Œè¿˜æ˜¯è¢«å¯¼å…¥åˆ°å…¶ä»–æ–‡ä»¶ä¸­**ã€‚

```
# ============ ä¸»ç¨‹åºå…¥å£ ============

if __name__ == "__main__":

Â  Â  # æŒ‡å®šè¦æ‹†åˆ†çš„ PDF æ–‡ä»¶è·¯å¾„

Â  Â  # ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸² (r"...") é¿å…åæ–œæ è½¬ä¹‰é—®é¢˜

Â  Â  target_pdf = r"E:\BaiduNetdiskDownload\MATLABä¿¡å·å¤„ç† ç®—æ³•ã€ä»¿çœŸä¸å®ç° -.pdf"

Â  Â  # è°ƒç”¨ä¸»å‡½æ•°å¼€å§‹å¤„ç†

Â  Â  process_and_split_pdf(target_pdf)
```